// --- 1. Game State & Stats ---
let time = 0.32;
let gas = 100;
let velocityY = 0;
let isGrounded = true;

// --- 2. Create the HUD (Visuals from your drawing) ---
const hud = document.createElement('div');
hud.style.position = 'absolute';
hud.style.top = '10px';
hud.style.left = '10px';
hud.style.color = 'white';
hud.style.fontFamily = 'Arial, sans-serif';
hud.innerHTML = `
    <div>TIME: <span id="time">0.32</span></div>
    <div style="margin-top:5px;">GAS: [ <span id="gas-bar">||||||||||</span> ] FULL</div>
    <div style="margin-top:5px;">LEVEL: 3</div>
`;
document.body.appendChild(hud);

// --- 3. Arrow Key & Space Controls ---
const keys = { ArrowUp: false, ArrowDown: false, ArrowLeft: false, ArrowRight: false };

window.addEventListener('keydown', (e) => {
    if (keys.hasOwnProperty(e.code)) keys[e.code] = true;
    if (e.code === 'Space' && isGrounded) {
        velocityY = 0.3; // The Jump
        isGrounded = false;
    }
});

window.addEventListener('keyup', (e) => {
    if (keys.hasOwnProperty(e.code)) keys[e.code] = false;
});

// --- 4. Physics & Movement Engine ---
function updateGame() {
    if (typeof car === 'undefined') return;

    // Jumping Physics
    car.position.y += velocityY;
    if (car.position.y > 0) {
        velocityY -= 0.01; // Gravity
    } else {
        car.position.y = 0;
        velocityY = 0;
        isGrounded = true;
    }

    // Arrow Key Driving
    if (keys.ArrowUp) car.position.z -= 0.1;
    if (keys.ArrowDown) car.position.z += 0.1;
    if (keys.ArrowLeft) car.position.x -= 0.1;
    if (keys.ArrowRight) car.position.x += 0.1;

    // Update Gas Bar
    if (keys.ArrowUp || keys.ArrowDown) {
        gas -= 0.05;
        document.getElementById('gas-bar').innerText = "|".repeat(Math.max(0, Math.floor(gas/10)));
    }
}

// --- 5. The Main Loop ---
function animate() {
    requestAnimationFrame(animate);
    updateGame();
    if (typeof renderer !== 'undefined') renderer.render(scene, camera);
}

animate();
